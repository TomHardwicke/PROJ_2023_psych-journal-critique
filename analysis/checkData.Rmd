---
title: "checkData"
output: html_document
date: "2023-08-21"
---

```{r setup, include=FALSE}
library(tidyverse)
library(here)
```

# Load data

```{r}
# article data (random)
d_articles_random <- read_csv(here('data','raw','articles (random) - Sheet1.csv')) %>%
  filter(!is.na(`primary coder initials`) & !is.na(`secondary coder initials`)) # we only need articles that we're coded by someone

# article data (prominent)
d_articles_prominent <- read_csv(here('data','raw','articles (prominent) - Sheet1.csv'))  %>%
  filter(!is.na(`primary coder initials`) & !is.na(`secondary coder initials`)) # we only need articles that we're coded by someone

# journal data (random and prominent sample)
d_journals <- read_csv(here('data','raw','Data Extraction Form (policy) (Responses) - Form Responses 1.csv'))

# list of journals in random sample
journal_list_random <- read_csv(here('data','prepareSample','journals', '03 - final', 'journals-random.csv')) %>%
  slice_head(n = 108) %>%
  select(`Journal`)

# list of journals in prominent sample
journal_list_prominent <- read_csv(here('data','prepareSample','journals', '03 - final', 'journals-prominent.csv')) %>%
  slice_head(n = 114) %>%
  select('Journal' = `Journal name`)
```

# Journals data

Remove pilot journals

```{r}
d_journals <- d_journals %>%
  filter(`Are you piloting?` == "No") %>%
  select(-`Are you piloting?`)
```

Change two journal names entered incorrectly so they match names in sample.

```{r}
d_journals <- d_journals %>% mutate(`Journal Name` = fct_recode(`Journal Name`, 
                                         "MEMORY & COGNITION" = "Memory & Cognition",
                                         "JOURNAL OF COUPLE & RELATIONSHIP THERAPY-INNOVATIONS IN CLINICAL AND EDUCATIONAL INTERVENTIONS" = "Journal of Couple & Relationship Therapy"))
```

```{r}
d2 <- d %>%
  mutate(
    sample_journal_prominent = `Journal Name` %in% journal_list_prominent$Journal,
    sample_journal_random = `Journal Name` %in% journal_list_random$Journal,
    sample_journal_both = sample_journal_prominent & sample_journal_random,
    sample_journal_error = !sample_journal_prominent & !sample_journal_random
  )
```

```{r}
d %>% 
  count(`Journal Name`) %>%
  filter(n > 2)
```

```{r}
d %>% filter(`Journal Name` == "CLINICAL PSYCHOLOGY-SCIENCE AND PRACTICE")
```

# Articles data

Find cases where primary and secondary coder disagreed on whether to exclude.

```{r}
d_articles_random %>%
  count(`1_exclusion`, `2_exclusion`)
```

On first pass, it looks like we have some exclusion disagreements. Let's identify the relevant papers:

```{r}
d_articles_random %>%
  filter(`1_exclusion` != `2_exclusion`)
```


Find cases where primary and secondary coder disagreed on whether to exclude.

```{r}
d_articles_prominent %>%
  count(`1_exclusion`, `2_exclusion`)
```

On first pass, it looks like we have some exclusion disagreements. Let's identify the relevant papers:

```{r}
d_articles_prominent %>%
  filter(`1_exclusion` != `2_exclusion`)
```

